!function(){"use strict";var e={};(function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})(e),window.newspackRAS=window.newspackRAS||[],window.newspackRAS.push((function(e){var t;t=function(){document.querySelectorAll(".newspack-registration").forEach((t=>{const n=t.querySelector("form");if(!n)return;const a=t.querySelector(".newspack-registration__response"),i=n.querySelector('input[type="submit"]');let o=t.querySelector(".newspack-registration__registration-success");n.startLoginFlow=()=>{a.classList.add("newspack-registration--hidden"),a.innerHTML="",i.disabled=!0,t.classList.add("newspack-registration--in-progress")},n.endLoginFlow=function(){let s,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(c?.existing_user&&(o=t.querySelector(".newspack-registration__login-success")),r){s=document.createElement("p"),s.classList.add("has-text-align-center"),s.textContent=r;const e=o.querySelector("p");e&&c?.sso&&e.replaceWith(s)}const l=200===d;t.classList.add("newspack-registration--"+(l?"success":"error")),l?(o.classList.remove("newspack-registration--hidden"),n.remove(),c?.email&&(e.setReaderEmail(c.email),e.setAuthenticated(c?.authenticated))):s&&(a.appendChild(s),a.classList.remove("newspack-registration--hidden")),i.disabled=!1,t.classList.remove("newspack-registration--in-progress")},n.addEventListener("submit",(t=>{if(t.preventDefault(),n.startLoginFlow(),!n.npe?.value)return n.endLoginFlow("Please enter a vaild email address.",400);e.getCaptchaToken().then((e=>{if(!e)return;let t=n.captcha_token;t||(t=document.createElement("input"),t.setAttribute("type","hidden"),t.setAttribute("name","captcha_token"),n.appendChild(t)),t.value=e})).catch((e=>{n.endLoginFlow(e,400)})).finally((()=>{const e=new FormData(n);if(!e.has("npe")||!e.get("npe"))return n.endFlow("Please enter a vaild email address.",400);fetch(n.getAttribute("action")||window.location.pathname,{method:"POST",headers:{Accept:"application/json"},body:e}).then((e=>{e.json().then((t=>{let{message:a,data:i}=t;return n.endLoginFlow(a,e.status,i)}))})).catch((e=>{n.endLoginFlow(e,400)}))}))})),e.on("reader",(e=>{let{detail:{authenticated:t}}=e;t&&n.endLoginFlow(null,200)}))}))},"undefined"!=typeof document&&("complete"!==document.readyState&&"interactive"!==document.readyState?document.addEventListener("DOMContentLoaded",t):t())}));var t=window;for(var n in e)t[n]=e[n];e.__esModule&&Object.defineProperty(t,"__esModule",{value:!0})}();